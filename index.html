<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.png?v=5.1.2" />






<meta property="og:type" content="website">
<meta property="og:title" content="Howard的學習之路">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Howard的學習之路">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Howard的學習之路">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>Howard的學習之路</title>
  




<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-111619338-1', 'auto');
  ga('send', 'pageview');
</script>











</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Howard的學習之路</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/12/26/Hyperas-在Keras中自動選擇超參數/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Howard Chang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Howard的學習之路">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/12/26/Hyperas-在Keras中自動選擇超參數/" itemprop="url">Hyperas - 在Keras中自動選擇超參數</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-12-26T15:50:25+08:00">
                2017-12-26
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Hyperas-在Keras中自動選擇超參數"><a href="#Hyperas-在Keras中自動選擇超參數" class="headerlink" title="Hyperas - 在Keras中自動選擇超參數"></a>Hyperas - 在Keras中自動選擇超參數</h1><p>這邊將介紹透過簡單範例<br>透過Hyperas選擇符合我們Model的最好超參數</p>
<h2 id="安裝Hyperas"><a href="#安裝Hyperas" class="headerlink" title="安裝Hyperas"></a>安裝Hyperas</h2><p>使用<code>pip</code>進行安裝</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ pip install hyperas</span><br></pre></td></tr></table></figure>
<h2 id="Import-Hyperas"><a href="#Import-Hyperas" class="headerlink" title="Import Hyperas"></a>Import Hyperas</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hyperopt <span class="keyword">import</span> Trials, STATUS_OK, tpe</span><br><span class="line"><span class="keyword">from</span> hyperas <span class="keyword">import</span> optim</span><br><span class="line"><span class="keyword">from</span> hyperas.distributions <span class="keyword">import</span> choice, uniform</span><br></pre></td></tr></table></figure>
<h2 id="Import-Keras"><a href="#Import-Keras" class="headerlink" title="Import Keras"></a>Import Keras</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> keras.models <span class="keyword">import</span> Sequential</span><br><span class="line"><span class="keyword">from</span> keras.layers.core <span class="keyword">import</span> Dense, Dropout, Activation</span><br><span class="line"><span class="keyword">from</span> keras.optimizers <span class="keyword">import</span> RMSprop</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> keras.datasets <span class="keyword">import</span> mnist</span><br><span class="line"><span class="keyword">from</span> keras.utils <span class="keyword">import</span> np_utils</span><br></pre></td></tr></table></figure>
<p>之後我們會依序</p>
<ol>
<li>定義Data</li>
<li>定義Model</li>
<li>Optimize model hyperparameters</li>
</ol>
<h2 id="定義Data"><a href="#定義Data" class="headerlink" title="定義Data"></a>定義Data</h2><p>使用<code>MNIST</code>的Data</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">data</span><span class="params">()</span>:</span></span><br><span class="line">    (X_train, y_train), (X_test, y_test) = mnist.load_data()</span><br><span class="line">    X_train = X_train.reshape(<span class="number">60000</span>, <span class="number">784</span>)</span><br><span class="line">    X_test = X_test.reshape(<span class="number">10000</span>, <span class="number">784</span>)</span><br><span class="line">    X_train = X_train.astype(<span class="string">'float32'</span>)</span><br><span class="line">    X_test = X_test.astype(<span class="string">'float32'</span>)</span><br><span class="line">    X_train /= <span class="number">255</span></span><br><span class="line">    X_test /= <span class="number">255</span></span><br><span class="line">    nb_classes = <span class="number">10</span></span><br><span class="line">    Y_train = np_utils.to_categorical(y_train, nb_classes)</span><br><span class="line">    Y_test = np_utils.to_categorical(y_test, nb_classes)</span><br><span class="line">    <span class="keyword">return</span> X_train, Y_train, X_test, Y_test</span><br></pre></td></tr></table></figure>
<h2 id="定義Model"><a href="#定義Model" class="headerlink" title="定義Model"></a>定義Model</h2><p>這邊除了定義Modle外，還需完成training及testing，所以需把data傳進來<br>最後回傳一個dictionary，其中包含：</p>
<ul>
<li>loss: Hyperas會去選擇最小值的model</li>
<li>status: 直接回傳<code>STATUS_OK</code></li>
<li>model: 可不回傳</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_model</span><span class="params">(X_train, Y_train, X_test, Y_test)</span>:</span></span><br><span class="line">    model = Sequential()</span><br><span class="line">    model.add(Dense(<span class="number">512</span>, input_shape=(<span class="number">784</span>,)))</span><br><span class="line">    model.add(Activation(<span class="string">'relu'</span>))</span><br><span class="line">    model.add(Dropout(&#123;&#123;uniform(<span class="number">0</span>, <span class="number">1</span>)&#125;&#125;))</span><br><span class="line">    model.add(Dense(&#123;&#123;choice([<span class="number">256</span>, <span class="number">512</span>, <span class="number">1024</span>])&#125;&#125;))</span><br><span class="line">    model.add(Activation(<span class="string">'relu'</span>))</span><br><span class="line">    model.add(Dropout(&#123;&#123;uniform(<span class="number">0</span>, <span class="number">1</span>)&#125;&#125;))</span><br><span class="line">    model.add(Dense(<span class="number">10</span>))</span><br><span class="line">    model.add(Activation(<span class="string">'softmax'</span>))</span><br><span class="line"></span><br><span class="line">    rms = RMSprop()</span><br><span class="line">    model.compile(loss=<span class="string">'categorical_crossentropy'</span>, optimizer=rms, metrics=[<span class="string">'accuracy'</span>])</span><br><span class="line">    </span><br><span class="line">    model.fit(X_train, Y_train,</span><br><span class="line">              batch_size=&#123;&#123;choice([<span class="number">64</span>, <span class="number">128</span>])&#125;&#125;,</span><br><span class="line">              nb_epoch=<span class="number">1</span>,</span><br><span class="line">              verbose=<span class="number">2</span>,</span><br><span class="line">              validation_data=(X_test, Y_test))</span><br><span class="line">    score, acc = model.evaluate(X_test, Y_test, verbose=<span class="number">0</span>)</span><br><span class="line">    print(<span class="string">'Test accuracy:'</span>, acc)</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">'loss'</span>: -acc, <span class="string">'status'</span>: STATUS_OK, <span class="string">'model'</span>: model&#125;</span><br></pre></td></tr></table></figure>
<p>原本Dropout需要傳入一個0~1的機率<br>但我們這邊不直接指定一個數字<br>而是透過<code>uniform</code>幫我們產生一個0~1的數字</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">model.add(Dropout(&#123;&#123;uniform(<span class="number">0</span>, <span class="number">1</span>)&#125;&#125;))</span><br></pre></td></tr></table></figure>
<p>Dense擇是透過<code>choice</code><br>傳入我們要哪些值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">model.add(Dense(&#123;&#123;choice([<span class="number">256</span>, <span class="number">512</span>, <span class="number">1024</span>])&#125;&#125;))</span><br></pre></td></tr></table></figure>
<p>最後回傳的dictionary<br>我們目標是選擇最高的accuracy的model<br>但因為Huperas他會去選擇<code>loss</code>這個value <strong>最小的</strong> 的model<br>所以將accuracy直接變 <strong>負號</strong><br>再丟給<code>loss</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> &#123;<span class="string">'loss'</span>: -acc, <span class="string">'status'</span>: STATUS_OK, <span class="string">'model'</span>: model&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Optimize-model-hyperparameters"><a href="#Optimize-model-hyperparameters" class="headerlink" title="Optimize model hyperparameters"></a>Optimize model hyperparameters</h2><p>最後透過<code>optim.minimize()</code>來找出最好的model</p>
<ul>
<li>model: 我們定義的model</li>
<li>data: 我們定義的data</li>
<li>algo: 使用TPE algorithm</li>
<li>max_evals: evaluation次數</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">X_train, Y_train, X_test, Y_test = data()</span><br><span class="line"></span><br><span class="line">best_run, best_model = optim.minimize(model=create_model,</span><br><span class="line">                                      data=data,</span><br><span class="line">                                      algo=tpe.suggest,</span><br><span class="line">                                      max_evals=<span class="number">5</span>,</span><br><span class="line">                                      trials=Trials())</span><br><span class="line"></span><br><span class="line">print(<span class="string">"Evalutation of best performing model:"</span>)</span><br><span class="line">print(best_model.evaluate(X_test, Y_test))</span><br></pre></td></tr></table></figure>
<h2 id="最後"><a href="#最後" class="headerlink" title="最後"></a>最後</h2><ol>
<li>Hyperas好像跟註解很不合，在跑程式時需把註解都刪掉，以免發生錯誤</li>
<li>如果是使用jupyter notebook需在<code>optim.minimize()</code>多加入<code>notebook_name</code>這個參數且設定為<code>ipynb</code>的檔名，假如目前為Untitled.ipynb就虛設定為：</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">best_run, best_model = optim.minimize(model=create_model,</span><br><span class="line">                                      data=data,</span><br><span class="line">                                      algo=tpe.suggest,</span><br><span class="line">                                      max_evals=<span class="number">5</span>,</span><br><span class="line">                                      trials=Trials(),</span><br><span class="line">                                      notebook_name=<span class="string">'Untitled'</span>)</span><br></pre></td></tr></table></figure>
<h2 id="參考"><a href="#參考" class="headerlink" title="參考"></a>參考</h2><p><a href="https://github.com/maxpumperla/hyperas" target="_blank" rel="noopener">https://github.com/maxpumperla/hyperas</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/12/25/FB-Messenger-Bot-建置教學/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Howard Chang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Howard的學習之路">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/12/25/FB-Messenger-Bot-建置教學/" itemprop="url">FB Messenger Bot 建置教學</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-12-25T22:08:29+08:00">
                2017-12-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="FB-Messenger-Bot-建置教學"><a href="#FB-Messenger-Bot-建置教學" class="headerlink" title="FB Messenger Bot 建置教學"></a>FB Messenger Bot 建置教學</h1><p>此教學為建置一個FB粉絲團自動回化的機器人之環境</p>
<h2 id="Facebook-Developer的APP建立"><a href="#Facebook-Developer的APP建立" class="headerlink" title="Facebook Developer的APP建立"></a>Facebook Developer的APP建立</h2><p>既然是要寫這項功能自然就是要開啟FB開發者的功能<br>到<a href="https://developers.facebook.com/" target="_blank" rel="noopener">https://developers.facebook.com/</a></p>
<p>點擊右上角的 <strong>「我的應用程式」</strong> -&gt; <strong>「新增應用程式」</strong></p>
<p><img src="/2017/12/25/FB-Messenger-Bot-建置教學/1.png" alt=""></p>
<p>輸入名稱及選擇類別後就可以建立應用程式了<br>並在Messenger選項點選 <strong>「開始使用」</strong></p>
<p><img src="/2017/12/25/FB-Messenger-Bot-建置教學/2.png" alt=""></p>
<h2 id="建立粉絲專頁存取權杖"><a href="#建立粉絲專頁存取權杖" class="headerlink" title="建立粉絲專頁存取權杖"></a>建立粉絲專頁存取權杖</h2><p>選擇粉絲團及產生一組權杖 <strong>(pageAccessToken)</strong></p>
<p><img src="/2017/12/25/FB-Messenger-Bot-建置教學/3.png" alt=""></p>
<h2 id="查看應用程式密鑰"><a href="#查看應用程式密鑰" class="headerlink" title="查看應用程式密鑰"></a>查看應用程式密鑰</h2><p>點選左上角的主控版查看應用程式密鑰 <strong>(appSecret)</strong></p>
<p><img src="/2017/12/25/FB-Messenger-Bot-建置教學/4.png" alt=""></p>
<p><img src="/2017/12/25/FB-Messenger-Bot-建置教學/5.png" alt=""></p>
<h2 id="建立HTTP-Server"><a href="#建立HTTP-Server" class="headerlink" title="建立HTTP Server"></a>建立HTTP Server</h2><p>這邊使用免費的虛擬主機 <a href="https://c9.io/" target="_blank" rel="noopener">https://c9.io/</a><br>辦完帳號就能建立一個新的workspaces<br>輸入name，且一定要選 <strong>Public</strong> 的權限<br>Git clone的URL輸入 <a href="https://github.com/fbsamples/messenger-platform-samples.git" target="_blank" rel="noopener">https://github.com/fbsamples/messenger-platform-samples.git</a><br>最後template選擇 <strong>Node.js</strong></p>
<p><img src="/2017/12/25/FB-Messenger-Bot-建置教學/6.png" alt=""></p>
<p>建立完成後在下方Terminal依序輸入下列指令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ cd node/</span><br><span class="line">$ npm install</span><br></pre></td></tr></table></figure>
<p>成功時會看到產生了 <strong>node_modules</strong> 資料夾<br>這時開啟 <strong>node/config/default.json</strong> 這個檔案</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;appSecret&quot;: &quot;&quot;,</span><br><span class="line">    &quot;pageAccessToken&quot;: &quot;&quot;,</span><br><span class="line">    &quot;validationToken&quot;: &quot;&quot;,</span><br><span class="line">    &quot;serverURL&quot;: &quot;&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>appSecret: 這邊填入應用程式密鑰</li>
<li>pageAccessToken: 粉絲專頁存取權杖</li>
<li>validationToken: 自己可以任意輸入，但要需要記住，等等下面會用到</li>
<li>serverURL: 輸入https:// <strong>專案名稱</strong> –<strong>帳號名稱</strong> .c9users.io</li>
</ul>
<p>完成後存檔並在下面Terminal輸入下列指令來啟動Server</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ node app.js</span><br></pre></td></tr></table></figure>
<p>成功時會看到 <strong>「Node app is running on port 8080」</strong></p>
<h2 id="設定Webhooks"><a href="#設定Webhooks" class="headerlink" title="設定Webhooks"></a>設定Webhooks</h2><p>回到FB Developer的頁面，點擊右邊的 <strong>「設定Webhooks」</strong></p>
<p><img src="/2017/12/25/FB-Messenger-Bot-建置教學/7.png" alt=""></p>
<p>在回呼網址輸入https:// <strong>專案名稱</strong> –<strong>帳號名稱</strong> .c9users.io/webhook<br>驗證權杖這邊輸入上面json裡 <strong>validationToken</strong> 的值<br>下面的訂閱欄位依自己需求勾選</p>
<p><img src="/2017/12/25/FB-Messenger-Bot-建置教學/8.png" alt=""></p>
<p>儲存完後就可以選訂閱的粉絲團</p>
<p><img src="/2017/12/25/FB-Messenger-Bot-建置教學/9.png" alt=""></p>
<h2 id="測試Bot"><a href="#測試Bot" class="headerlink" title="測試Bot"></a>測試Bot</h2><p>到粉絲團頁面，選擇「更多」 -&gt; 「以粉絲專頁訪客的身分檢視」<br>就可以傳送訊息給粉絲團了</p>
<p><img src="/2017/12/25/FB-Messenger-Bot-建置教學/10.png" alt=""></p>
<p>看到Bot成功回你輸入的訊息就代表成功囉</p>
<p><img src="/2017/12/25/FB-Messenger-Bot-建置教學/11.png" alt=""></p>
<h2 id="客制化回話"><a href="#客制化回話" class="headerlink" title="客制化回話"></a>客制化回話</h2><p>主要修改app.js這檔案</p>
<ul>
<li>收到訊息的事件在 function receivedMessage(event)</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Message Event</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * This event is called when a message is sent to your page. The 'message' </span></span><br><span class="line"><span class="comment"> * object format can vary depending on the kind of message that was received.</span></span><br><span class="line"><span class="comment"> * Read more at https://developers.facebook.com/docs/messenger-platform/webhook-reference/message-received</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * For this example, we're going to echo any text that we get. If we get some </span></span><br><span class="line"><span class="comment"> * special keywords ('button', 'generic', 'receipt'), then we'll send back</span></span><br><span class="line"><span class="comment"> * examples of those bubbles to illustrate the special message bubbles we've </span></span><br><span class="line"><span class="comment"> * created. If we receive a message with an attachment (image, video, audio), </span></span><br><span class="line"><span class="comment"> * then we'll simply confirm that we've received the attachment.</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">receivedMessage</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>傳送訊息的方法在 function sendTextMessage(recipientId, messageText)</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Send a text message using the Send API.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sendTextMessage</span>(<span class="params">recipientId, messageText</span>) </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>基本上只要用這兩個Function就能客制化自己的機器人囉~</p>
<h2 id="參考"><a href="#參考" class="headerlink" title="參考"></a>參考</h2><p><a href="http://animabeautifullife.blogspot.tw/2016/06/facebook-messenger-api.html" target="_blank" rel="noopener">http://animabeautifullife.blogspot.tw/2016/06/facebook-messenger-api.html</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/12/25/緩衝區溢位原理/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Howard Chang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Howard的學習之路">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/12/25/緩衝區溢位原理/" itemprop="url">緩衝區溢位原理</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-12-25T21:43:38+08:00">
                2017-12-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="緩衝區溢位原理"><a href="#緩衝區溢位原理" class="headerlink" title="緩衝區溢位原理"></a>緩衝區溢位原理</h1><h2 id="目的"><a href="#目的" class="headerlink" title="目的"></a>目的</h2><p>指的是利用程式的漏洞，向緩衝衝區寫入使溢位的值，可用來達到以下目的：</p>
<ul>
<li>程序破壞</li>
<li>控制程式流程</li>
<li>取得系統的控制權</li>
</ul>
<p>以下將透過編寫簡單的程式，並輸入過長字串讓程序當掉，以了解緩衝區溢位的原理。</p>
<h2 id="環境介紹"><a href="#環境介紹" class="headerlink" title="環境介紹"></a>環境介紹</h2><ul>
<li>OS：Windows XP_x86 (SP3)</li>
<li>IDE：VC++ 6.0</li>
</ul>
<h2 id="事前準備及利用緩衝區漏洞"><a href="#事前準備及利用緩衝區漏洞" class="headerlink" title="事前準備及利用緩衝區漏洞"></a>事前準備及利用緩衝區漏洞</h2><p>這裡以C寫一段存在緩衝區漏洞的程式</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">char</span> name[] = <span class="string">"HAO-WEI"</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> buffer[<span class="number">8</span>];</span><br><span class="line">    <span class="built_in">strcpy</span>(buffer, name);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%s \n"</span>, buffer);</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>這段程式是先宣告name變數資料型態為Char的陣列，並設值為”HAO-WEI”，<br>並在主程式中，宣告buffer變數一樣為Char的陣列的資料型態，設定與name變數相同長度，因為HAO-WEI後面還有一個’\0′<br>使用strcpy函數將name的字串複製給buffer，最後再輸出。</p>
<p><img src="/2017/12/25/緩衝區溢位原理/1-1.jpg" alt=""></p>
<p>以上是有存在緩衝區溢位的程式碼，這邊思考一下，如果name的長度比8更長，或是buffer長度比8小，讓他真的發生緩衝區溢位，那麼會發生什麼事呢？<br>這邊將name內容設為HAO-WEIHAO-WEI，長度為15，並編譯執行</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">char</span> name[] = <span class="string">"HAO-WEI"</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> buffer[<span class="number">8</span>];</span><br><span class="line">    <span class="built_in">strcpy</span>(buffer, name);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%s \n"</span>, buffer);</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2017/12/25/緩衝區溢位原理/1-1-b.jpg" alt=""></p>
<p>程序雖然成功的輸出HAO-WEIHAO-WEI，但隨即就當掉了。<br>緩衝區不就只是滿了，為什麼會發生這樣的事情呢？</p>
<h2 id="分析說明"><a href="#分析說明" class="headerlink" title="分析說明"></a>分析說明</h2><p>要解釋這個問題時，先講解程式在執行時Stack運作原理<br>程式在直行時會有一塊記憶體是存放Stack的部分<br>當進入副程式時，系統會給予這副程式一塊可用記憶體，稱為Stack Frame(如下圖)</p>
<p><img src="/2017/12/25/緩衝區溢位原理/stack.jpg" alt=""></p>
<p>其中epb跟esp都是暫存器的值</p>
<ul>
<li>epb表示Stack底端</li>
<li>esp表示Stack頂端</li>
</ul>
<p>每一個Stack Frame都有屬於自己的esp跟ebp<br>所以只要把epb的值+4就可以拿到這個Function的變數2的值<br>epb的值+8也就可以拿到變數1的值<br>而最上面綠色那塊則是這Function可用的其他記憶體空間<br>另外也會把這個Function完成後<br>等等要執行下一個指令的位置寫到Return Address這裡<br>也會把呼叫這個Function的舊ebp保存起來<br>以供結束此Function能夠回復上一個Function的ebp<br>這樣Function一直不斷呼叫，記憶體不斷的往上疊，也不會亂掉，因為每個Function只需在意他自己的ebp跟esp</p>
<p>這邊用OllyDbg來進行動態分析，以了解程式的組合語言以及執行時的Stack變化</p>
<h3 id="進入FUNCTION前"><a href="#進入FUNCTION前" class="headerlink" title="進入FUNCTION前"></a>進入FUNCTION前</h3><p>我們先把程式停在進入Ｍain()這個Function前<br>另外也需特別注意下一個指令的位置00401699<br>結束完Main()時會繼續往這裡走，所以需要把這個位置寫到Stack中(等等下面圖片會看到)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">00401694        CALL BufferOv.00401005　// 表示CALL Main()</span><br></pre></td></tr></table></figure>
<p><img src="/2017/12/25/緩衝區溢位原理/1-1-c.png" alt=""></p>
<p>以及他的Stack狀況</p>
<p><img src="/2017/12/25/緩衝區溢位原理/1-1-d.png" alt=""></p>
<p>可以知道目前esp為0012FF88</p>
<h3 id="進入FUNCTION後"><a href="#進入FUNCTION後" class="headerlink" title="進入FUNCTION後"></a>進入FUNCTION後</h3><p>觀察一下Stack狀態<br>就可以發現目前的esp變為0012FF24<br>而ebp為0012FF80 其值為0012FFC0(上一個Function的ebp)<br>而0012FF84(ebp + 4) 其值為00401699(為Main()執行完要回去的位置，也稱Return Address)<br>而這個Main()所用記憶體也就是0012FF24 ~ 0012FF7C這些空間</p>
<p><img src="/2017/12/25/緩衝區溢位原理/1-1-h.png" alt=""></p>
<h3 id="執行STRCPY前"><a href="#執行STRCPY前" class="headerlink" title="執行STRCPY前"></a>執行STRCPY前</h3><p>我們來看一下Main()裡面寫到的strcpy這Function的C語言以及其對應組合語言的部分</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">strcpy</span>(buffer, name);</span><br></pre></td></tr></table></figure>
<p>strcpy的API</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">char</span> * <span class="title">strcpy</span> <span class="params">( <span class="keyword">char</span> * destination, <span class="keyword">const</span> <span class="keyword">char</span> * source )</span></span>;</span><br></pre></td></tr></table></figure>
<p><img src="/2017/12/25/緩衝區溢位原理/1-1-g.png" alt=""></p>
<p>可以知道他把”HAO-WEI”這些字串拷貝到[ebp – 8]也就是0012FF78這個位置上</p>
<h3 id="執行STRCPY後"><a href="#執行STRCPY後" class="headerlink" title="執行STRCPY後"></a>執行STRCPY後</h3><p>我們來看看0012FF78這個位置的值發生什麼變化</p>
<p><img src="/2017/12/25/緩衝區溢位原理/1-1-i.png" alt=""></p>
<p>已經被填入”HAO-WEI”的字串了，看起來沒什麼問題<br>那如果是填入過長字串如”HAO-WEIHAO-WEI”會怎樣呢？我們來看看</p>
<p><img src="/2017/12/25/緩衝區溢位原理/1-1-j.png" alt=""></p>
<p>結果發現0012FF84原本放Main()執行完要去的位置被覆寫掉了，變成00004945<br>意謂著等等結束Main()會跳到00004945位置繼續執行指令，而這個位置如果是空的，程式自然就會當掉，發生以下情形</p>
<p><img src="/2017/12/25/緩衝區溢位原理/1-1-k.png" alt=""></p>
<p>很明顯的圖片上出現的0x00004945就是這個意思</p>
<h2 id="最後"><a href="#最後" class="headerlink" title="最後"></a>最後</h2><p>換個角度想，如果覆寫掉的這個位置是存在的，就樣是不是就能控制程式流程，隨心所欲的跳到想要的位置呢？</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/12/25/Spark與Flume之環境建置/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Howard Chang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Howard的學習之路">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/12/25/Spark與Flume之環境建置/" itemprop="url">Spark與Flume之環境建置</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-12-25T21:19:32+08:00">
                2017-12-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Spark與Flume之環境建置"><a href="#Spark與Flume之環境建置" class="headerlink" title="Spark與Flume之環境建置"></a>Spark與Flume之環境建置</h1><p>這篇教學會說明如何透過Flume來蒐集某一檔案的變化<br>將檔案變動的部分傳給Spark進行即時性的WordCount運算</p>
<h2 id="什麼是Flume？"><a href="#什麼是Flume？" class="headerlink" title="什麼是Flume？"></a>什麼是Flume？</h2><p>Flume是一個從可以收集例如日誌，事件等數據資源，並將這些數量龐大的數據從各項數據資源中集中起來存儲的工具與服務，或者數集中機制。</p>
<h2 id="環境布建"><a href="#環境布建" class="headerlink" title="環境布建"></a>環境布建</h2><p>Spark環境可參考我之前的文章來安裝</p>
<h4 id="Flume安裝"><a href="#Flume安裝" class="headerlink" title="Flume安裝"></a>Flume安裝</h4><p>下載可以到 <a href="http://flume.apache.org/download.html" target="_blank" rel="noopener">http://flume.apache.org/download.html</a></p>
<p>這邊我使用<code>apache-flume-1.7.0</code>來進行安裝</p>
<p>一樣安裝到<code>HOME</code>目錄下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ cd ~</span><br><span class="line">$ wget http://apache.stu.edu.tw/flume/1.7.0/apache-flume-1.7.0-bin.tar.gz</span><br><span class="line">$ tar zxvf apache-flume-1.7.0-bin.tar.gz</span><br></pre></td></tr></table></figure>
<p>環境變數的部分使用<code>vim ~/.bashrc</code>來加入Flume的環境變數</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export FLUME_HOME=~/apache-flume-1.7.0-bin</span><br><span class="line">export PATH=$PATH:$FLUME_HOME/bin</span><br></pre></td></tr></table></figure>
<p>使用下面指令來生效</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ source ~/.bashrc</span><br></pre></td></tr></table></figure>
<p>輸入下面指令看看是否成功</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ flume-ng version</span><br></pre></td></tr></table></figure>
<p><img src="/2017/12/25/Spark與Flume之環境建置/FlumeInstall.png" alt=""></p>
<h4 id="Flume-Assembly"><a href="#Flume-Assembly" class="headerlink" title="Flume Assembly"></a>Flume Assembly</h4><p>要藉由Flume把檔案變動的資料傳給Spark需要<code>Spark Project External Flume Assembly</code>的jar</p>
<p>所以可以到 <a href="http://mvnrepository.com/artifact/org.apache.spark/spark-streaming-flume-assembly_2.10" target="_blank" rel="noopener">http://mvnrepository.com/artifact/org.apache.spark/spark-streaming-flume-assembly_2.10</a></p>
<p>這邊我選擇<code>2.1.0</code>並且下載到Spark目錄裡的<code>/jars</code>裡</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ cd ~/spark-2.1.0-bin-hadoop2.7/jars</span><br><span class="line">$ wget http://central.maven.org/maven2/org/apache/spark/spark-streaming-flume-assembly_2.10/2.1.0/spark-streaming-flume-assembly_2.10-2.1.0.jar</span><br></pre></td></tr></table></figure>
<blockquote>
<p>~/spark-2.1.0-bin-hadoop2.7/jars這是我的目錄，請依自己的目錄為準</p>
</blockquote>
<h4 id="Flume-Configure"><a href="#Flume-Configure" class="headerlink" title="Flume Configure"></a>Flume Configure</h4><p>這邊主要是Flume要偵測哪一檔案的變化、及與Spark溝通port的相關設定</p>
<p>到剛剛下載並解壓縮完的Flume目錄下的<code>/conf</code></p>
<p>使用<code>vim wordcount.conf</code>新增一個檔案並加入下面設定</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">a1.channels = c1</span><br><span class="line">a1.sinks = k1</span><br><span class="line">a1.sources = r1</span><br><span class="line"></span><br><span class="line">a1.sinks.k1.type = avro</span><br><span class="line">a1.sinks.k1.channel = c1</span><br><span class="line">a1.sinks.k1.hostname = localhost</span><br><span class="line">a1.sinks.k1.port = 29999</span><br><span class="line"></span><br><span class="line">a1.sources.r1.type = exec</span><br><span class="line">a1.sources.r1.command = tail -F /home/spark/test.txt</span><br><span class="line">a1.sources.r1.channels = c1</span><br><span class="line"></span><br><span class="line">a1.channels.c1.type = memory</span><br><span class="line">a1.channels.c1.capacity = 1000</span><br><span class="line">a1.channels.c1.transactionCapacity = 100</span><br></pre></td></tr></table></figure>
<blockquote>
<p>/home/spark/test.txt 這是我要偵測的檔案，請依照自己的檔案為準<br>a1.sinks.k1.port = 29999 則是等等要與Spark建立起溝通用的port</p>
</blockquote>
<h2 id="執行"><a href="#執行" class="headerlink" title="執行"></a>執行</h2><h4 id="Spark"><a href="#Spark" class="headerlink" title="Spark"></a>Spark</h4><p>這邊使用Spakr本身就用python寫好的WordCount程式<br>到Spark目錄下使用下面指令來執行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ bin/spark-submit --jars jars/spark-streaming-flume-assembly_2.10-2.1.0.jar examples/src/main/python/streaming/flume_wordcount.py localhost 29999</span><br></pre></td></tr></table></figure>
<h4 id="Flume"><a href="#Flume" class="headerlink" title="Flume"></a>Flume</h4><p>到Flume目錄下使用下面指令來執行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ bin/flume-ng agent --conf conf --conf-file ~/apache-flume-1.7.0-bin/conf/wordcount.conf --name a1 -Dflume.root.logger=INFO,console</span><br></pre></td></tr></table></figure>
<h4 id="更改檔案"><a href="#更改檔案" class="headerlink" title="更改檔案"></a>更改檔案</h4><p>Spark與Flume都執行起來後，就會看到Spark每1秒接收一次資料<br>我們對要偵測的檔案寫入一些字進去，看看Spark是否有接收到並執行WordCount</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ echo &apos;a b b c c c&apos; &gt;&gt; /home/spark/test.txt</span><br></pre></td></tr></table></figure>
<blockquote>
<p>/home/spark/test.txt 這是我要偵測的檔案，請依照自己的檔案為準</p>
</blockquote>
<p><img src="/2017/12/25/Spark與Flume之環境建置/SparkReceivedData.png" alt=""></p>
<blockquote>
<p>這邊要注意的一點是需先執行Spark，接著再執行Flume</p>
</blockquote>
<h2 id="參考"><a href="#參考" class="headerlink" title="參考"></a>參考</h2><p><a href="https://kknews.cc/zh-tw/tech/nxn2ng.html" target="_blank" rel="noopener">https://kknews.cc/zh-tw/tech/nxn2ng.html</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/12/25/Standalone-Mode的佈建-二/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Howard Chang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Howard的學習之路">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/12/25/Standalone-Mode的佈建-二/" itemprop="url">Standalone Mode的佈建 二</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-12-25T21:12:51+08:00">
                2017-12-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Standalone-Mode的佈建-二"><a href="#Standalone-Mode的佈建-二" class="headerlink" title="Standalone Mode的佈建 二"></a>Standalone Mode的佈建 二</h1><p>上一篇會發現我需要一一到Master與各個Slave中進行開啟的動作<br>今天電腦數量少還沒問題，但萬一數量多就不方便了<br>所以這篇要教的是如何只需啟動Master就能把Standalone的環境一次佈建好<br>其實概念很簡單，就是Master會自己透過SSH一一到各個Slave中進行啟動的動作</p>
<h2 id="環境介紹"><a href="#環境介紹" class="headerlink" title="環境介紹"></a>環境介紹</h2><p>這邊一樣，有三台電腦分別為：</p>
<table>
<thead>
<tr>
<th style="text-align:center">Hostname</th>
<th style="text-align:center">Username</th>
<th style="text-align:center">IP</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Master</td>
<td style="text-align:center">spark</td>
<td style="text-align:center">192.168.2.101</td>
</tr>
<tr>
<td style="text-align:center">Slave1</td>
<td style="text-align:center">spark</td>
<td style="text-align:center">192.168.2.102</td>
</tr>
<tr>
<td style="text-align:center">Slave2</td>
<td style="text-align:center">spark</td>
<td style="text-align:center">192.168.2.103</td>
</tr>
</tbody>
</table>
<p>基本上Username都要取一樣以及Spark放的路徑也要一樣<br>目標一樣是在Slave1跟Slave2上建立起Worker Node</p>
<h2 id="環境設定"><a href="#環境設定" class="headerlink" title="環境設定"></a>環境設定</h2><h4 id="Hostname設定"><a href="#Hostname設定" class="headerlink" title="Hostname設定"></a>Hostname設定</h4><p>在Master與所有Slave的<code>/etc/hosts</code>加入各Hostname與IP對應，如下</p>
<p><img src="/2017/12/25/Standalone-Mode的佈建-二/Hosts.png" alt=""></p>
<p>要知道是否成功，可以在Master直接ping測試，如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ping Slave1</span><br></pre></td></tr></table></figure>
<blockquote>
<p>ping Slave1就等於ping 192.168.2.102</p>
</blockquote>
<p><img src="/2017/12/25/Standalone-Mode的佈建-二/PingTest.png" alt=""></p>
<h4 id="SSH免密碼登入設定"><a href="#SSH免密碼登入設定" class="headerlink" title="SSH免密碼登入設定"></a>SSH免密碼登入設定</h4><p>先安裝SSH</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ apt-get install openssh-server</span><br></pre></td></tr></table></figure>
<blockquote>
<p>一般要SSH連線都需要密碼，但其實可以透過建立起SSH public/private keys來進行免密碼登入<br>假設我想在A電腦免密碼登入B電腦，就先在A電腦產生public/private keys<br>並將A電腦的public key放到B電腦的~/.ssh/authorized_keys裡<br>A電腦就能不需要密碼直接登入B電腦了</p>
</blockquote>
<p>所以我們要做的是在Master產生SSH public/private keys<br>並透過ssh-copy-id指令將Master的public key複製到各個Slave的</p>
<p><code>~/.ssh/authorized_keys</code>檔案裡，做法如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ ssh-keygen -t rsa</span><br><span class="line">$ ssh-copy-id -i ~/.ssh/id_rsa.pub spark@Slave1</span><br><span class="line">$ ssh-copy-id -i ~/.ssh/id_rsa.pub spark@Slave2</span><br></pre></td></tr></table></figure>
<blockquote>
<p>在下ssh-keygen -t rsa指令時，它會要求一堆資訊直接按Enter到底就行了</p>
</blockquote>
<p>在Master輸入完上面指令後，來測試一下是否免密碼登入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ssh spark@Slave1</span><br></pre></td></tr></table></figure>
<h4 id="配置Worker-Node"><a href="#配置Worker-Node" class="headerlink" title="配置Worker Node"></a>配置Worker Node</h4><p>來到Master下，先到Spark目錄下的<code>/conf</code></p>
<p>複製<code>slaves.template</code>一份為<code>slaves</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cp slaves.template slaves</span><br></pre></td></tr></table></figure>
<p>修改slaves檔案，把要當作Worker Node的Hostname加進去，如下</p>
<p><img src="/2017/12/25/Standalone-Mode的佈建-二/SlavesConf.png" alt=""></p>
<p>把這份檔案複製給各個Slave的Spark目錄下<code>/conf</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ scp -r slaves spark@Slave1:~/spark-2.1.0-bin-hadoop2.7/conf</span><br><span class="line">$ scp -r slaves spark@Slave2:~/spark-2.1.0-bin-hadoop2.7/conf</span><br></pre></td></tr></table></figure>
<h2 id="執行Standalone"><a href="#執行Standalone" class="headerlink" title="執行Standalone"></a>執行Standalone</h2><p>最後，直接在Master的Spark目錄<code>/sbin</code>下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ./start-all.sh</span><br></pre></td></tr></table></figure>
<p>如果要結束就輸入下面指令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ./stop-all.sh</span><br></pre></td></tr></table></figure>
<p><img src="/2017/12/25/Standalone-Mode的佈建-二/StartStandalone.png" alt=""></p>
<p>一樣到瀏覽器Master_IP:8080就會看到Slave1與Slave2已經當作Worker Node加進來了</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/12/25/Standalone-Mode的佈建-一/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Howard Chang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Howard的學習之路">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/12/25/Standalone-Mode的佈建-一/" itemprop="url">Standalone Mode的佈建 一</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-12-25T20:57:33+08:00">
                2017-12-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Standalone-Mode的佈建-一"><a href="#Standalone-Mode的佈建-一" class="headerlink" title="Standalone Mode的佈建 一"></a>Standalone Mode的佈建 一</h1><h2 id="Cluster群集介紹"><a href="#Cluster群集介紹" class="headerlink" title="Cluster群集介紹"></a>Cluster群集介紹</h2><p><img src="http://spark.apache.org/docs/latest/img/cluster-overview.png" alt=""></p>
<p>Spark可以建立群集來跨資源分配，基本上有三種模式可以選擇：</p>
<ul>
<li><strong>Standalone</strong></li>
<li>Apache Mesos</li>
<li>Hadoop YARN</li>
</ul>
<p>這邊以Standalone來介紹如何建立環境</p>
<h2 id="環境介紹"><a href="#環境介紹" class="headerlink" title="環境介紹"></a>環境介紹</h2><p>這邊有三台電腦分別為：</p>
<table>
<thead>
<tr>
<th style="text-align:center">Hostname</th>
<th style="text-align:center">IP</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Master</td>
<td style="text-align:center">192.168.2.101</td>
</tr>
<tr>
<td style="text-align:center">Slave1</td>
<td style="text-align:center">192.168.2.102</td>
</tr>
<tr>
<td style="text-align:center">Slave2</td>
<td style="text-align:center">192.168.2.103</td>
</tr>
</tbody>
</table>
<h2 id="環境設定"><a href="#環境設定" class="headerlink" title="環境設定"></a>環境設定</h2><h4 id="Master設定"><a href="#Master設定" class="headerlink" title="Master設定"></a>Master設定</h4><p>到Spark目錄下的<code>/sbin</code>執行下面指令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ./start-master.sh --host [Master_IP]</span><br></pre></td></tr></table></figure>
<blockquote>
<p>以我的例子，Master_IP就是192.168.2.101</p>
</blockquote>
<p>執行完後，Master的位置會在192.168.2.101:7077(預設port)<br>在瀏覽器輸入Master_IP:8080，就會看到下面畫面</p>
<p><img src="/2017/12/25/Standalone-Mode的佈建-一/SparkGUI.PNG" alt=""></p>
<h4 id="Slave設定"><a href="#Slave設定" class="headerlink" title="Slave設定"></a>Slave設定</h4><p>分別在每個Slave上建立起Worker Node<br>所以到各個Slave輸入下列指令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ./start-slave.sh spark://[Master_IP]:7077</span><br></pre></td></tr></table></figure>
<p>將Slave1、Slave2都加進來後會看到下面畫面</p>
<p><img src="/2017/12/25/Standalone-Mode的佈建-一/MasterAndWorkersGUI.PNG" alt=""></p>
<h2 id="執行Application"><a href="#執行Application" class="headerlink" title="執行Application"></a>執行Application</h2><h4 id="Spark-Shell"><a href="#Spark-Shell" class="headerlink" title="Spark-Shell"></a>Spark-Shell</h4><p>一樣到Spark目錄下的<code>/bin</code>執行之前所使用的Spark-Shell<br>但比較不一樣的，這次要指定Master</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ spark-shell --master spark://[Master_IP]:7077</span><br></pre></td></tr></table></figure>
<p><img src="/2017/12/25/Standalone-Mode的佈建-一/Spark-ShellWithMaster.png" alt=""></p>
<h4 id="PI迭代計算"><a href="#PI迭代計算" class="headerlink" title="PI迭代計算"></a>PI迭代計算</h4><p>這邊我們實際玩個例子<br>可以來跑一下官方自帶的Example Code<br>以python所寫的迭代計算PI<br>到Spark目錄下的<code>/examples/src/main/python</code><br>執行下面指令，來迭代10次算出PI</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ spark-submit --master spark://[Master_IP]:7077 pi.py 10</span><br></pre></td></tr></table></figure>
<p><img src="/2017/12/25/Standalone-Mode的佈建-一/CalcPI.png" alt=""></p>
<h2 id="結束Standlaone-Mode"><a href="#結束Standlaone-Mode" class="headerlink" title="結束Standlaone Mode"></a>結束Standlaone Mode</h2><p>到Spark目錄下的<code>/sbin</code>執行下面指令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ./stop-all.sh</span><br></pre></td></tr></table></figure>
<h2 id="參考"><a href="#參考" class="headerlink" title="參考"></a>參考</h2><p><a href="http://spark.apache.org/docs/latest/spark-standalone.html" target="_blank" rel="noopener">http://spark.apache.org/docs/latest/spark-standalone.html</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/12/25/Spark環境快速安裝/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Howard Chang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Howard的學習之路">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/12/25/Spark環境快速安裝/" itemprop="url">Spark環境快速安裝</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-12-25T19:52:23+08:00">
                2017-12-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Spark環境快速安裝"><a href="#Spark環境快速安裝" class="headerlink" title="Spark環境快速安裝"></a>Spark環境快速安裝</h1><p>先介紹一下我佈署的環境：</p>
<ul>
<li>Ubuntu 16.04 LTS</li>
<li>Java 8</li>
<li>Scala 2.12.1</li>
<li>Spark 2.1.0</li>
<li>Hadoop 2.7</li>
</ul>
<p>佈建Spark環境之前，需要先裝Java、Scala</p>
<p>下面會一步一步教如何安裝</p>
<blockquote>
<p>教學最後我也寫了一個Script來幫助自動安裝</p>
</blockquote>
<h2 id="Java環境安裝"><a href="#Java環境安裝" class="headerlink" title="Java環境安裝"></a>Java環境安裝</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ add-apt-repository ppa:webupd8team/java</span><br><span class="line">$ apt-get update</span><br><span class="line">$ apt-get install -y oracle-java8-installer</span><br><span class="line">$ apt-get install -y oracle-java8-set-default</span><br></pre></td></tr></table></figure>
<h2 id="Scala環境安裝"><a href="#Scala環境安裝" class="headerlink" title="Scala環境安裝"></a>Scala環境安裝</h2><p>因為我想裝在<code>HOME</code>目錄，所以cd到<code>HOME</code>目錄，這邊可以依照自行決定下載路徑</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ cd ~</span><br><span class="line">$ wget http://downloads.lightbend.com/scala/2.12.1/scala-2.12.1.tgz</span><br><span class="line">$ tar -xzvf scala-2.12.1.tgz</span><br></pre></td></tr></table></figure>
<h2 id="Spark-Hadoop環境安裝"><a href="#Spark-Hadoop環境安裝" class="headerlink" title="Spark + Hadoop環境安裝"></a>Spark + Hadoop環境安裝</h2><p>基本上可以到官方網站<a href="http://spark.apache.org/downloads.html" target="_blank" rel="noopener">http://spark.apache.org/downloads.html</a></p>
<p>選擇你要的版本，這邊我是選spark-2.1.0-bin-hadoop2.7來做下載</p>
<p>我還是將它放到<code>HOME</code>目錄底下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ cd ~</span><br><span class="line">$ wget http://d3kbcqa49mib13.cloudfront.net/spark-2.1.0-bin-hadoop2.7.tgz</span><br><span class="line">$ tar -xzvf spark-2.1.0-bin-hadoop2.7.tgz</span><br></pre></td></tr></table></figure>
<h2 id="環境變數"><a href="#環境變數" class="headerlink" title="環境變數"></a>環境變數</h2><p>到這裡該下載的都完成了，再來就是設定環境變數</p>
<p>主要是編輯<code>~/.bashrc</code>這個檔案，在裡面新增下列指令</p>
<p>這邊要注意的一點是，<code>SPARK_HOME</code>與<code>SCALA_HOME</code>這邊是我剛剛下載的路徑，所以請按照自己環境設定</p>
<p>而<code>JAVA_HOME</code>一般來講是不用動的</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">export SPARK_HOME=~/spark-2.1.0-bin-hadoop2.7</span><br><span class="line">export SCALA_HOME=~/scala-2.12.1</span><br><span class="line">export JAVA_HOME=/usr/lib/jvm/java-8-oracle</span><br><span class="line">export PATH=$SCALA_HOME/bin:$SPARK_HOME/bin:$JAVA_HOME/bin:$PATH</span><br></pre></td></tr></table></figure>
<p>加入上列4條環境變數後，就可執行下面指令來生效</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ source ~/.bashrc</span><br></pre></td></tr></table></figure>
<h2 id="執行Spark"><a href="#執行Spark" class="headerlink" title="執行Spark"></a>執行Spark</h2><p>最後一步就是執行Spark看看是否成功</p>
<p>到Spark目錄下的<code>/bin</code>執行下面指令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ spark-shell</span><br></pre></td></tr></table></figure>
<p>看到下面結果就表示成功囉<br><img src="/2017/12/25/Spark環境快速安裝/Spark-Shell.png" alt=""></p>
<h2 id="自動安裝"><a href="#自動安裝" class="headerlink" title="自動安裝"></a>自動安裝</h2><p>在新的環境直接跑下面指令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ wget https://raw.githubusercontent.com/aswergbh888/Spark/master/Install/SparkInstaller.sh -O - | sh</span><br></pre></td></tr></table></figure>
<p>Spark會安裝在<code>HOME</code>目錄，所以要執行spark-shell就輸入下面指令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ~/spark-2.1.0-bin-hadoop2.7/bin/spark-shell</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/avatar.jpg"
               alt="Howard Chang" />
          <p class="site-author-name" itemprop="name">Howard Chang</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">7</span>
                <span class="site-state-item-name">posts</span>
              </a>
            </div>
          

          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">4</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/aswergbh888" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                    
                      GitHub
                    
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="aswergbh888@gmail.com" target="_blank" title="E-Mail">
                  
                    <i class="fa fa-fw fa-envelope"></i>
                  
                    
                      E-Mail
                    
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Howard Chang</span>
</div>


<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  

  
    <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  






  





  

  

  

  

  

  

</body>
</html>
